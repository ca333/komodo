<html lang="fr">
	<head>
	<meta charset="UTF-8">
	<meta name='viewport' content="width=device-width,user-scalable=no, initial-scale=1,maximum-scale=1,user-scalable=0" />
	<meta name='apple-mobile-web-app-capable' content="yes" />
	<meta name='apple-mobile-we-app-status-bar-style' content="black-translucent" />

	<style type="text/css">
			@font-face {
			    font-family: 'Roboto';
			    src: url('assets/font/RobotoCondensed/RobotoCondensed-bold.ttf'); /* IE */
			}
			body { margin: 0; padding: 0; background: #DFEFEE; }
			#canvas-container { position: relative; margin: 0 auto; }
      canvas { position: relative; display:block; margin:0 auto; background: #FFF; margin-top: 10px; margin-bottom: 10px;}
      .dialog { position: absolute; z-index: 1; visibility: hidden; font-family: 'Arial'; font-size: 22px; background: #FFF; padding: 10px 30px; }
      .dialog > h1 { font-family: 'Roboto'; font-size: 60px; }
	</style>

	</head>

	<body onload="loaded()">
			<div id="canvas-container">
				<canvas id="canvas" width="1500" height="800"><!-- dont touch the dimension, it is use to calculate the proportion --></canvas>
			</div>
			<div style="display: none;">
        <img src="assets/img/Komodo-icon.png" alt="" id="komodo-logo">
      </div>
	</body>


	<script src="lib/createjs/1.0/createjs.min.js"></script>
	<script src="lib/justice.mapped.min.js"></script>
	<script src="lib/gl-matrix-min.js"></script>
	<script src="lib/victor/victor.min.js"></script>
	<script src="lib/victor/victor_custom.js"></script>
	<script src="lib/dat/dat.gui.min.js"></script>
	<script src="lib/canvas.pointiller.js"></script>
	<script src="commons/utils.js" type="text/javascript"></script>
	<script src="commons/tweens.js" type="text/javascript"></script>
	<script src="js/blockchains/blockchain.js" type="text/javascript"></script>
	<script src="js/blockchains/block.js" type="text/javascript"></script>
	<script src="js/blockchains/emitter.js" type="text/javascript"></script>
	<script src="js/blockchains/mempool.js" type="text/javascript"></script>
	<script src="js/blockchains/timeline.js" type="text/javascript"></script>
	<script src="js/blockchains/transaction.js" type="text/javascript"></script>
	<script src="js/dialog.js" type="text/javascript"></script>
	<script src="js/main.js" type="text/javascript"></script>

  <script type="text/javascript">

	window.initStage = function() {

		Cont_main = new createjs.Container();
		Stage.addChild(Cont_main);

		Cont_background = new createjs.Container();
		Cont_main.addChild(Cont_background);

    Cont_timeline = new createjs.Container();
    Cont_main.addChild(Cont_timeline);

    Cont_blockchain = new createjs.Container();
    Cont_main.addChild(Cont_blockchain);

    Cont_mempool = new createjs.Container();
    Cont_main.addChild(Cont_mempool);

    Cont_emitter = new createjs.Container();
    Cont_main.addChild(Cont_emitter);

    let minuteWidth = 120;
    let minuteSeconds = 2;

    Timeline = new Timeline({
      width: STAGEWIDTH,
      height: STAGEHEIGHT,
      minuteWidth: minuteWidth,
      minuteSeconds: minuteSeconds,
      defaultTime: 7,
    });
    Cont_timeline.addChild(Timeline);


    let bitcoin = new Blockchain({name: 'bitcoin', blockTime: 10, color: 'orange', 'premined': 0, maxTps: 10});
    bitcoin.x = 0;
    bitcoin.y = 100;
    bitcoin.initMempool();
    Cont_blockchain.addChild(bitcoin);
    Blockchains.push(bitcoin);

    let komodo = new Blockchain({name: 'komodo', color:'#306565', premined: 6, notarizeTo: 'bitcoin', notarizeInterval: 10, notarizeNBlock: 1, showBigNotaryLabel: true});
    komodo.x = 0;
    komodo.y = 300;
    komodo.initMempool();
    Cont_blockchain.addChild(komodo);
    Blockchains.push(komodo);

    let SC1 = new Blockchain({name: 'SC1', color:'#569b9b', type: 'SC', premined: 6, notarizeTo: 'komodo', notarizeInterval: 1, notarizeNBlock: 1});
    SC1.x = 0;
    SC1.y = 400;
    SC1.initMempool();
    Cont_blockchain.addChild(SC1);
    Blockchains.push(SC1);
    SC1.drawMoMoMMagic();

    let AC1 = new Blockchain({name: 'AC1', color:'#198201', type: 'AC', ccc: ['dice','reward','asset'], premined: 6, notarizeTo: 'komodo', notarizeInterval: 1, notarizeNBlock: 1});
    AC1.x = 0;
    AC1.y = 500;
    AC1.initMempool();
    Cont_blockchain.addChild(AC1);
    Blockchains.push(AC1);
    AC1.drawMoMoMMagic();

    let AC2 = new Blockchain({name: 'AC2', color:'#d49100', type: 'AC', ccc: ['oracle','faucet','cog'], premined: 6, notarizeTo: 'komodo', notarizeInterval: 1, notarizeNBlock: 1});
    AC2.x = 0;
    AC2.y = 600;
    AC2.initMempool();
    Cont_blockchain.addChild(AC2);
    Blockchains.push(AC2);
    AC2.drawMoMoMMagic();


		const pointiller = new Pointiller(500, 500);
    const logo = document.querySelector('#komodo-logo');
    pointiller.addImage(logo,500,500);
    pointiller.excludeColor([255,255,255], 10);
    const points = pointiller.toPoints(5);
    for(let i=0,ln=points.length; i<ln; i++) {
    	let point = points[i];
    	let circle = new createjs.Shape();
    	circle.graphics.beginFill('rgba('+point.r+','+point.g+','+point.b+','+point.a+')').drawCircle(point.x, point.y, point.w/2);
    	Cont_background.addChild(circle);
    }
    Cont_background.x = STAGEWIDTH/2 - 250;
    Cont_background.y = STAGEHEIGHT/2 - 250;
    Cont_background.alpha = 0.1;
    Cont_background.cache(0, 0, STAGEWIDTH, STAGEHEIGHT);

    var emitter = new Emitter({name:"komodo", size: 100, color: '#306565'});
    emitter.x = STAGEWIDTH;
    emitter.y = komodo.y;
    emitter.addChain(komodo);
    emitter.addChain(SC1);
    emitter.addChain(AC1);
    emitter.addChain(AC2);
    Cont_emitter.addChild(emitter);
    Emitters.push(emitter);

    var emitter = new Emitter({name:"bitcoin", size: 100, color: 'orange'});
    emitter.x = STAGEWIDTH;
    emitter.y = bitcoin.y;
    emitter.addChain(bitcoin);
    Cont_emitter.addChild(emitter);
    Emitters.push(emitter);


  }

  </script>
</html>
